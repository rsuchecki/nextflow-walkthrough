params {
  outdir = "./results" //can be overwritten at run-time e.g. --outdir dirname
  infodir = "./flowinfo" //can be overwritten at run-time e.g. --infodir dirname
  n = 1 //can be overwritten at run-time e.g. --n 2 to just process first two accessions
  //For read trimming
  adapters = "https://raw.githubusercontent.com/timflutre/trimmomatic/master/adapters/TruSeq3-PE.fa"
  adapters_local = "data/misc/TruSeq3-PE.fa"
  pipes = false //Alternative sytax for DSL2 workflows
  nested = false //if not pipes, use the nested workflow syntax
}

process {
  cache = 'lenient'
}

profiles {
  //EXECUTORS (the default is 'local')
  slurm {
    process {
      executor = 'slurm'
    }
  }
  //SOFTWARE
  conda {
    process {
      conda = "$baseDir/conf/conda.yaml"
    }
  }
  docker {
    process.container = 'rsuchecki/nextflow-embl-abr-webinar'
    docker {
      enabled = true
      fixOwnership = true
    }
  }
  modules {
    includeConfig 'conf/modules.config'
  }
  singularity {
    envWhitelist = 'SINGULARITY_BINDPATH, SINGULARITYENV_LD_LIBRARY_PATH'
    cacheDir = "$NXF_HOME/singularity"
    process {	    
	    container = 'docker://rsuchecki/nextflow-embl-abr-webinar' //remote  - limited pulls per day - you can also specify a local path as below:
      //container = 'singularity-images/rsuchecki-nextflow-embl-abr-webinar.img' //assuming this has been copied into place or downloaded
      //scratch = true //This is a hack needed for singularity versions approx after 2.5 and before 3.1.1 as a workaround for https://github.com/sylabs/singularity/issues/1469#issuecomment-469129088
    }
    singularity {
      enabled = true
      autoMounts = true
      cacheDir = "singularity-images"  //when distibuting the pipeline probably should point under $workDir
    }
  }
}

//SETUP DATA (OPTIONAL) - we use this to download data for this workshop 
includeConfig 'conf/data.config'

//GENERATE REPORT https://nextflow.io/docs/edge/tracing.html#execution-report
report {
    enabled = true
    overwrite = true
    file = "${params.infodir}/report.html"
}

//GENERATE TIMELINE https://nextflow.io/docs/edge/tracing.html#timeline-report
timeline {
    enabled = true
    overwrite = true
    timeline.file = "${params.infodir}/timeline.html"
}

//GENERATE PIPELINE TRACE https://www.nextflow.io/docs/edge/tracing.html#trace-report
trace {
    enabled = true
    overwrite = true
    file = "${params.infodir}/trace.txt"
}

//GENERATE GRAPH REPRESENTATION OF THE PIPELINE FLOW https://nextflow.io/docs/edge/tracing.html#dag-visualisation
dag {
    enabled = true
    overwrite = true
    file = "${params.infodir}/flowchart.dot"
    // file = "${params.infodir}/flowchart.png" //requires graphviz for rendering
}
